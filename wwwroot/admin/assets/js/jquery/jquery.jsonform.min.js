!function(e){e.fn.jsonForm=function(t){t=e.extend({},e.fn.jsonForm.defaults,t);var o=this,n=e(this);function r(e){n.trigger(e.type,arguments)}this.source=t.source,o.jsonFormEventKind={SELECT:"selected",LOADED:"loaded",UPDATE:"update"},doBind=function(a,i){a&&(n=e(a)),i&&(o.source=i);var s=e(":input",n),u="";e.each(s,function(n){if((u=e(s[n])).bind("focus.jsonform",function(){r({type:"jsonformField",kind:o.jsonFormEventKind.SELECT,form:o,field:u,object:this,data:o.source,value:e(this).val()})}),"all"==t.bindTo||u.attr(t.bindTo)){var a=u.attr(t.bindBy);"text"==u.attr("type")&&!u.attr("disabled")||u.is("textarea")?(u.val(o.source[a]),u.unbind("keyup.jsonform"),(t.createOnDataNull||null!=o.source[a])&&(o.source[a]=e(this).val()),u.bind("keyup.jsonform",function(){o.source[a]!=e(this).val()&&(r({type:"jsonformField",kind:o.jsonFormEventKind.UPDATE,form:o,field:u,data:o.source,item:a,object:this,value:e(this).val()}),t.autoChange&&(t.createOnNull||null!=o.source[a])&&(o.source[a]=e(this).val()))})):"hidden"==u.attr("type")||"text"==u.attr("type")&&u.attr("disabled")?(u.val(o.source[a]),u.unbind("change.jsonform"),(t.createOnDataNull||null!=o.source[a])&&(o.source[a]=e(this).val()),u.bind("change.jsonform",function(){o.source[a]!=e(this).val()&&(r({type:"jsonformField",kind:o.jsonFormEventKind.UPDATE,form:o,field:u,data:o.source,item:a,object:this,value:e(this).val()}),t.autoChange&&(t.createOnNull||null!=o.source[a])&&(o.source[a]=e(this).val()))})):"checkbox"==u.attr("type")?(u.unbind("click.jsonform"),1==o.source[a]?u.attr("CHECKED","CHECKED"):u.removeAttr("checked"),(t.createOnDataNull||null!=o.source[a])&&(o.source[a]=e(this).is(":checked")?e(this).val():0),u.bind("click.jsonform",function(){r({type:"jsonformField",kind:o.jsonFormEventKind.UPDATE,form:o,field:u,data:o.source,item:a,object:this,value:e(this).val()}),t.autoChange&&(t.createOnNull||null!=o.source[a])&&(o.source[a]=e(this).is(":checked")?e(this).val():0)})):u.is("select")?(u.unbind("change.jsonform"),u.val(o.source[a]),(t.createOnDataNull||null!=o.source[a])&&(o.source[a]=e(this).val()),u.bind("change.jsonform",function(){r({type:"jsonformField",kind:o.jsonFormEventKind.UPDATE,form:o,field:u,data:o.source,item:a,object:this,value:e(this).val()}),t.autoChange&&(t.createOnNull||null!=o.source[a])&&(o.source[a]=e(this).val())})):"radio"==u.attr("type")&&(u.unbind("click.jsonform"),u.val()==o.source[a]?u.attr("CHECKED","CHECKED"):u.removeAttr("checked"),(t.createOnDataNull||null!=o.source[a])&&(o.source[a]=e(this).val()),u.bind("click.jsonform",function(){r({type:"jsonformField",kind:o.jsonFormEventKind.UPDATE,form:o,field:u,data:o.source,item:a,object:this,value:e(this).val()}),t.autoChange&&(t.createOnNull||null!=o.source[a])&&(o.source[a]=e(this).val())}))}}),r({type:"jsonformForm",kind:o.jsonFormEventKind.LOADED,form:o,data:o.source})},t.autoBind&&doBind()},e.jsonForm={},e.fn.jsonForm.defaults={source:{},root:"",autoChange:!0,autoBind:!0,bindTo:"all",bindBy:"name",bindPattern:"",createOnNull:!1,createOnDataNull:!1},e.jsonForm.setSource=function(e,t){doBind(e,t)}}(jQuery);