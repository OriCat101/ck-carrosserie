!function(a){var e=function(a,e,r){return Array.prototype.slice.call(a,e,r)};function r(e){e.stopPropagation?e.stopPropagation():a.event&&(a.event.cancelBubble=!0)}function t(a){a.dataTransfer.setData("Text",""),a.dataTransfer.dropEffect="copy",dragEl=this,elDropHandled=!1,newMuraObject=!1,muraLooseDropTarget=null,MuraInlineEditor.sidebarAction("showobjects"),Mura(".mura-object-selected").removeClass("mura-object-selected"),Mura(this).addClass("mura-object-selected")}function o(){dragEl=null,elDropHandled=!1,newMuraObject=!1,Mura(".mura-object-selected").removeClass("mura-object-selected")}function s(a){if(a.preventDefault(),a.dataTransfer.dropEffect="copy",dragEl||newMuraObject){var e=Mura(".mura-drop-target");muraLooseDropTarget=this,e.length&&(e.removeClass("mura-drop-target").removeClass("mura-append").removeClass("mura-prepend"),e.attr("class")||e.removeAttr("class")),Mura(this).addClass("mura-drop-target").addClass("mura-"+n(a,this))}}function d(a){Mura(this).removeClass("mura-drop-target").removeClass("mura-append").removeClass("mura-prepend"),muraLooseDropTarget=null,Mura(this).attr("class")||Mura(this).removeAttr("class")}function n(a,e){var r=e.getBoundingClientRect(),t=r.top,o=(r.bottom-t)/2+t;return a.clientY>o?"append":"prepend"}function l(a){var e=Mura(".mura-drop-target").node;if(e&&(dragEl||newMuraObject)){if(dragEl&&dragEl!=this){var t=n(a,e);if("container"==e.getAttribute("data-object")){var o=Mura(e).children(".mura-object-content");if(!o.length)return;o.node.childNodes.length?o[t](dragEl):o.append(dragEl)}else"append"==t?e.parentNode.insertBefore(dragEl,e.nextSibling):e.parentNode.insertBefore(dragEl,e);Mura("#adminSave").show(),Mura(e).closest(".mura-region-local").data("dirty",!0),elDropHandled=!0,r(a)}else dragEl==e&&(elDropHandled=!0,r(a));M.call(e,a)}Mura(".mura-drop-target").removeClass("mura-drop-target").removeClass("mura-append").removeClass("mura-prepend"),muraLooseDropTarget=null,newMuraObject=!1,Mura(e).attr("class")||Mura(e).removeAttr("class")}function u(a){Mura(".mura-active-target").removeClass("mura-active-target"),Mura(this).hasClass("mura-object-selected")||Mura(this).addClass("mura-active-target")}function i(a){Mura(this).removeClass("mura-active-target")}function c(a){var e=Mura(a);if("container"==e.data("object"))var r=!0;else;e.off("dragenter",t).off("dragover",s).off("drop",l).off("dragleave",d).on("dragstart",t).on("dragend",o).on("dragover",s).on("dragleave",d).on("drop",l).attr("draggable",!0).hover(u,i,r)}function m(a,e,r){if(a.closest(".mura-region").length){for(var t=a.parent().closest(".mura-object");t.length&&"container"!=t.data("object");)a=t,t=t.parent().closest(".mura-object");a.length&&a.addClass("mura-drop-target").addClass("mura-"+n(e,r))}}function g(a){if(a.preventDefault(),a.dataTransfer.dropEffect="copy",!Mura(".mura-drop-target").length&&(dragEl||newMuraObject)){var e=Mura(this).closest(".mura-object");e.length?m(e,a,this):Mura(this).addClass("mura-drop-target").addClass("mura-"+n(a,this))}}function p(a){if(a.preventDefault(),dragEl||newMuraObject){var e=Mura(".mura-drop-target");muraLooseDropTarget=this,e.length&&(e.removeClass("mura-drop-target").removeClass("mura-append").removeClass("mura-prepend"),e.attr("class")||e.removeAttr("class"));var r=Mura(this).closest(".mura-object");r.length?m(r,a,this):(r=Mura(this).closest(".mura-object")).length?r.addClass("mura-drop-target").addClass("mura-"+n(a,this)):Mura(this).addClass("mura-drop-target").addClass("mura-"+n(a,this))}}function f(a){Mura(this).removeClass("mura-drop-target").removeClass("mura-append").removeClass("mura-prepend"),muraLooseDropTarget=null,Mura(this).attr("class")||Mura(this).removeAttr("class")}function h(a){if(r(a),dragEl||newMuraObject){var e=Mura(".mura-drop-target").node;if(e){if(dragEl&&dragEl!=e){var t=n(a,e);if("container"==e.getAttribute("data-object")){var o=Mura(e).children(".mura-object-content");o.node.childNodes.length?o[t](dragEl):o.append(dragEl)}else try{"append"==t?e.parentNode.insertBefore(dragEl,e.nextSibling):e.parentNode.insertBefore(dragEl,e)}catch(a){}var s=Mura(dragEl);Mura("#adminSave").show(),s.addClass("mura-async-object"),"text"==s.data("object")&&"client"==s.data("render")&&"false"==s.data("async")||s.data("async",!0),Mura(e).closest(".mura-region-local").data("dirty",!0),Mura(e).hasClass("mura-object")?c(e):b(this),elDropHandled=!0,r(a)}else dragEl==e&&(elDropHandled=!0,r(a));M.call(e,a)}}Mura(".mura-drop-target").removeClass("mura-drop-target").removeClass("mura-append").removeClass("mura-prepend"),muraLooseDropTarget=null,newMuraObject=!1,Mura(this).attr("class")||Mura(this).removeAttr("class")}function b(a){Mura(a).off("dragenter",g).off("dragover",p).off("drop",h).off("dragleave",f).on("dragenter",g).on("dragover",p).on("dragleave",f).on("drop",h)}function v(){Mura(".mura-objectclass").each(function(){var a=Mura(this);a.data("inited")||(a.attr("draggable",!0),a.on("dragstart",function(e){dragEl=null,elDropHandled=!1,newMuraObject=!0,muraLooseDropTarget=null,Mura("#dragtype").html(a.data("object")),Mura(".mura-sidebar").addClass("mura-sidebar--dragging"),e.dataTransfer.setData("text",JSON.stringify({object:a.data("object"),objectname:a.data("objectname"),objectid:a.data("objectid"),objecticonclass:a.data("objecticonclass")}))}).on("dragend",function(){Mura("#dragtype").html(""),dragEl=null,elDropHandled=!1,newMuraObject=!1,Mura(".mura-sidebar").removeClass("mura-sidebar--dragging")}),a.data("inited",!0))})}function M(a){a.preventDefault(),a.stopPropagation&&a.stopPropagation();var e=a.dataTransfer.getData("text");if(""!=e)try{e=JSON.parse(e)}catch(a){e=""}if("object"==typeof e&&e.object){var t=document.createElement("DIV");t.setAttribute("data-object",e.object),t.setAttribute("data-objectname",e.objectname),t.setAttribute("data-objecticonclass",e.objecticonclass),t.setAttribute("data-async",!0),t.setAttribute("data-perm","author"),t.setAttribute("data-instanceid",Mura.createUUID()),t.setAttribute("class","mura-async-object mura-object mura-active"),e.objectid?t.setAttribute("data-objectid",e.objectid):t.setAttribute("data-objectid",Mura.createUUID());var o=Mura(this),s=n(a,this);if(o.hasClass("mura-object"))if("container"==this.getAttribute("data-object")){var d=o.children(".mura-object-content");d.node.childNodes.length?d[s](t):d.append(t)}else"append"==s?this.parentNode.insertBefore(t,this.nextSibling):this.parentNode.insertBefore(t,this);else o.hasClass("mura-region-local")?this.appendChild(t):"append"==s?this.parentNode.insertBefore(t,this.nextSibling):this.parentNode.insertBefore(t,this);c(t),openFrontEndToolsModal(t,!0),Mura.processAsyncObject(t),Mura(t).closest(".mura-region-local").data("dirty",!0),Mura(t).on("dragover",function(){}),Mura("#adminSave").show(),r(a)}}function j(a){a.preventDefault(),a.dataTransfer.dropEffect="copy"}function C(a){var t,o,s;if(a.preventDefault(),!Mura(this).find(".mura-object").length)return a.stopPropagation&&a.stopPropagation(),dragEl&&dragEl!==this?(t=this.parentNode,s=e(dragEl.parentNode.children).indexOf(dragEl),o=e(this.parentNode.children).indexOf(this),this.parentNode===dragEl.parentNode&&o>s?t.insertBefore(dragEl,this.nextSibling):this.appendChild(dragEl),Mura("#adminSave").show(),Mura(dragEl).data("async",!0),Mura(dragEl).addClass("mura-async-object"),Mura(this).data("dirty",!0),elDropHandled=!0,r(a)):dragEl==this&&(elDropHandled=!0,r(a)),M.call(this,a),muraLooseDropTarget=null,Mura(".mura-drop-target").removeClass("mura-drop-target").removeClass("mura-append").removeClass("mura-prepend"),!0}Mura.initLayoutManager=function(a){Mura.loader().loadjs(Mura.adminpath+"/assets/js/ios-drag-drop.js",function(){if(a){var e=a.node?a:Mura(a);a=a.node||a}else e=Mura("body"),a=e.node,v(),Mura("body").removeClass("mura-sidebar-state__hidden--right").addClass("mura-sidebar-state__pushed--right");Mura("#frontEndToolsSidebariframe"),Mura("label.mura-editable-label").show(),e.find(".mxp-editable").each(function(){var a=Mura(this);a.hasClass("mura-region-local")||(a.addClass("mura-region-local"),a.data("inited",!1),a.data("loose",!0),a.data("perm","editor"))}),e.find('.mura-region-local[data-inited="false"]').each(function(){var a=Mura(this);(!a.data("loose")||a.data("loose")&&"<p></p>"==a.html()||""==Mura.trim(a.html()))&&a.on("drop",C).on("dragover",j).data("inited","true")}),e.find(".mura-region-local .mura-object").each(function(){c(this)}),e.find('.mura-object[data-object="container"], .mura-region-local div, .mura-region-local[data-loose="true"] p, .mura-region-local[data-loose="true"] h1, .mura-region-local[data-loose="true"] h2, .mura-region-local[data-loose="true"] h3, .mura-region-local[data-loose="true"] h4, .mura-region-local[data-loose="true"] img, .mura-region-local[data-loose="true"] table, .mura-region-local[data-loose="true"] article, .mura-region-local[data-loose="true"] dl').each(function(){b(this)}),e.find(".mura-body-object").hover(u,i)})},Mura.deInitLayoutManager=function(){Mura.editing=!1,Mura("body").addClass("mura-sidebar-state__hidden--right"),Mura("body").removeClass("mura-sidebar-state__pushed--right"),Mura(".mura-object, .mura-body-object").each(function(){Mura(this).off("dragenter",t).off("dragover",s).off("drop",l).off("dragleave",d).off("dragstart",t).off("dragend",o).off("mouseover",u).off("mouseout",i).off("touchstart",u).off("touchend",i).attr("draggable",!1).removeClass("mura-active").removeClass("mura-object-selected").removeClass("mura-object-select").removeClass("mura-active-target"),Mura(".mura-region-local").off("drop",C).off("dragover",j).data("inited","false"),Mura('.mura-object[data-object="container"], .mura-region-local div, .mura-region-local[data-loose="true"] p, .mura-region-local[data-loose="true"] h1, .mura-region-local[data-loose="true"] h2, .mura-region-local[data-loose="true"] h3, .mura-region-local[data-loose="true"] h4, .mura-region-local[data-loose="true"] img, .mura-region-local[data-loose="true"] table, .mura-region-local[data-loose="true"] article, .mura-region-local[data-loose="true"] dl').off("dragenter",g).off("dragover",p).off("drop",h).off("dragleave",f),Mura(".mura-editable-attribute").each(function(){var a=Mura(this);if("undefined"!=typeof CKEDITOR&&CKEDITOR.instances[a.attr("id")]){var e=CKEDITOR.instances[a.attr("id")];e.updateElement(),e.destroy(!0)}a.attr("contenteditable","false"),a.removeClass("mura-active"),a.data("manualedit",!1),a.off("dblclick")})})},Mura.loadObjectClass=function(a,e,r,t,o,s){var d="muraAction=cArch.loadclass&compactDisplay=true&layoutmanager=true&siteid="+a+"&classid="+e+"&subclassid="+r+"&contentid="+t+"&parentid="+o+"&cacheid="+Math.random();if("plugins"==e)var n=Mura("#pluginList");else n=Mura("#classList"),Mura("#classListContainer").show();return n.html(Mura.preloaderMarkup),Mura.ajax({url:Mura.adminpath+"?"+d,success:function(a){n.html(a),v()}}),!1},Mura.initLooseDropTarget=b,Mura.initDraggableObject=c,Mura.initDraggableObject_hoverin=u,Mura.initDraggableObject_hoverout=i}(window);